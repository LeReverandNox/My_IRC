!function(){"use strict";angular.module("my_irc",["ngMaterial","ngSanitize","ui.router","btford.socket-io","luegg.directives","youtube-embed","angular-web-notification"])}(),function(){"use strict";function a(a,c,d){d.html5Mode(!0),b().forEach(function(b){a.state(b.state,b.config)}),c.otherwise("/")}function b(){return[{state:"index",config:{url:"/",templateUrl:"partials/index.html",controller:"Index",controllerAs:"I"}}]}angular.module("my_irc").config(a),a.$inject=["$stateProvider","$urlRouterProvider","$locationProvider"]}(),function(){"use strict";function a(a){a.theme("default").primaryPalette("blue").backgroundPalette("blue-grey")}angular.module("my_irc").config(a),a.$inject=["$mdThemingProvider"]}(),function(){"use strict";function a(a,b){function c(){e.channels.forEach(function(a){a.active&&(a.active=!1)})}var d=this,e=b.I;d.title="Channels",a.$on("selfJoinChannel",function(b,c){var f=e.addChannel(c.channelName);d.switchChannel(f),a.$emit("selfJoinChannelMessage",c)}),a.$on("selfLeaveChannel",function(b,c){var f=e.removeChannel(c.channelName);e.channels.length>0?f.active&&d.switchChannel(e.channels[0]):d.switchChannel(),a.$emit("selfLeftChannelMessage",c)}),d.switchChannel=function(a){c(),e.changeCurrentChannel(a)&&(a.active=!0,e.resetUnreadCount(a))}}angular.module("my_irc").controller("Channels",a),a.$inject=["$rootScope","$scope"]}(),function(){"use strict";function a(a,b,c){function d(a,b){b.preventDefault();var c;switch(a){case"up":c=e();break;case"down":c=f()}h.command=c}function e(){return h.historyCursor+=1,h.historyCursor<=h.commandHistory.length?h.commandHistory[h.historyCursor-1]:(h.historyCursor-=1,h.commandHistory[h.historyCursor-1])}function f(){return h.historyCursor-=1,h.historyCursor>=0?h.commandHistory[h.historyCursor-1]:(h.historyCursor+=1,"")}function g(a){h.commandHistory.unshift(a)}var h=this,i=b.I;h.title="Commands",h.command="",h.commandHistory=[],h.historyCursor=0,h.submitCommand=function(){c.go(h.command,i.currChannel.name),h.command="",h.historyCursor=0},h.keyCatcher=function(a){var b=a.keyCode;13===b&&(a.shiftKey||(a.preventDefault(),h.submitCommand())),38===b&&d("up",a),40===b&&d("down",a)},a.$on("addToHistory",function(a,b){g(b)})}angular.module("my_irc").controller("Commands",a),a.$inject=["$rootScope","$scope","commandsParserService"]}(),function(){"use strict";function a(a,b){function c(){d.channels=[],d.personnalChannel={name:"Personnal Channel",messages:[],unreadCount:0},d.currChannel=d.personnalChannel,d.message=null,d.nickname=null}var d=this;d.title="My_IRC",d.focus=!0,d.message=null,d.nickname=null,c(),d.addChannel=function(a){var b={name:a,users:[],messages:[],unreadCount:0,active:!1};return d.channels.push(b),b},d.removeChannel=function(a){var b=d.channels.findIndex(function(b){return b.name===a});return d.channels.splice(b,1)[0]},d.changeCurrentChannel=function(a){return a?(d.currChannel=a,d.currChannel):(d.currChannel=d.personnalChannel,null)},d.getChannelByName=function(a){var b=d.channels.filter(function(b){return b.name===a})[0];return b},d.incUnreadCount=function(a){a.unreadCount+=1,d.updateUnreadCount()},d.resetUnreadCount=function(a){a.unreadCount=0,d.updateUnreadCount()},d.updateUnreadCount=function(){var b=0;d.channels.forEach(function(a){b+=a.unreadCount}),b+=d.personnalChannel.unreadCount,a.$emit("updateUnreadCount",b)},a.$on("handshake",function(a,b){d.message=b.message,d.nickname=b.nickname}),a.$on("disconnect",function(a){c()}),a.$on("selfChangeNickname",function(a,b){b.newNickname&&(d.nickname=b.newNickname,d.message=d.message.replace(b.oldNickname,b.newNickname))}),b.onfocus=function(){d.focus=!0,d.resetUnreadCount(d.currChannel)},b.onblur=function(){d.focus=!1}}angular.module("my_irc").controller("Index",a),a.$inject=["$rootScope","$window"]}(),function(){"use strict";function a(a,b,c,d){function e(a,b){var d=c.format(b);f(d,b.channel)}function f(a,b){if(b){var c=h.getChannelByName(b);c.messages.push(a),b!==h.currChannel.name?(h.incUnreadCount(c),a.nickname!==h.nickname&&d.show(b,a)):h.focus||(h.incUnreadCount(c),d.show(b,a))}else h.currChannel.messages.push(a),h.focus||(h.incUnreadCount(h.currChannel),d.show(h.currChannel.name,a))}var g=this,h=b.I;g.title="Messages",g.channels=h.channels,a.$on("hasChangeNickname",e),a.$on("userJoinChannel",e),a.$on("userLeftChannel",e),a.$on("listChannelUsers",e),a.$on("receiveMessage",e),a.$on("selfJoinChannelMessage",e),a.$on("selfLeftChannelMessage",e),a.$on("selfChangeNickname",e),a.$on("listChannels",e),a.$on("selfPrivateMessageSent",e),a.$on("receivePrivateMessage",e),a.$on("selfMessageSent",e),a.$on("listCommands",e),a.$on("giphyError",e),a.$on("selfMeAction",e),a.$on("selfAmeAction",e),a.$on("selfMessageAllSent",e),a.$on("whois",e),a.$on("listServerUsers",e),a.$on("getUptime",e),a.$on("unknowCommand",e)}angular.module("my_irc").controller("Messages",a),a.$inject=["$rootScope","$scope","formatterService","notificationsService"]}(),function(){"use strict";function a(a){var b=this;b.appTitle="My_IRC",b.unreadCount=0,a.$on("updateAppTitle",function(a,c){b.appTitle=c}),a.$on("updateUnreadCount",function(a,c){b.unreadCount=c})}angular.module("my_irc").controller("Title",a),a.$inject=["$rootScope"]}(),function(){"use strict";function a(a,b){var c=this,d=b.I;c.title="Users",c.channels=d.channels,a.$on("updateUsersInChannel",function(a,b){var c=d.getChannelByName(b.data.channel);c.users=b.data.users})}angular.module("my_irc").controller("Users",a),a.$inject=["$rootScope","$scope"]}(),function(){"use strict";function a(){function a(a,b,c){}var b={restrict:"EA",link:a,templateUrl:"/partials/channels-list.html",controller:"Channels",controllerAs:"C",bindToController:!0};return b}angular.module("my_irc").directive("channelsList",a)}(),function(){"use strict";function a(){function a(a,b,c){}var b={restrict:"EA",link:a,templateUrl:"/partials/commands-box.html",controller:"Commands",controllerAs:"Co",bindToController:!0};return b}angular.module("my_irc").directive("commandsBox",a)}(),function(){"use strict";function a(){function a(a,b,c){}var b={restrict:"EA",link:a,templateUrl:"/partials/messages-list.html",controller:"Messages",controllerAs:"M",bindToController:!0};return b}angular.module("my_irc").directive("messagesList",a)}(),function(){"use strict";function a(){function a(a,b,c){}var b={restrict:"EA",link:a,templateUrl:"/partials/users-list.html",controller:"Users",controllerAs:"U",bindToController:!0};return b}angular.module("my_irc").directive("usersList",a)}(),function(){"use strict";function a(a,b){function c(b,c){a.emit("joinChannel",b,c)}function d(b,c){a.emit("leaveChannel",b,c)}function e(b,c){a.emit("listChannelUsers",b,c)}function f(b,c){a.emit("listChannels",b,c)}var g={joinChannel:c,leaveChannel:d,listChannelUsers:e,listChannels:f};return a.on("userJoinChannel",function(a){b.$emit("userJoinChannel",a)}),a.on("userLeftChannel",function(a){b.$emit("userLeftChannel",a)}),a.on("updateUsersInChannel",function(a){b.$emit("updateUsersInChannel",a)}),g}angular.module("my_irc").factory("channelsIrcService",a),a.$inject=["socketService","$rootScope"]}(),function(){"use strict";function a(a,b){function c(a,b){a=a.trim();var c=this.parse(a);this.decide(c.cmd,c.arg1,c.arg2,b,a)}function d(a){var b,c,d;if(a.match(/^\//)){var e=a.match(/^\/([a-zA-Z0-9]*)/);b=e?e[1]:"";var f=a.match(/\s(.[^\s]*)/);c=f?f[1]:"";var g=a.match(/^(?:[^\s]*\s){2}([^]*)/);d=g?g[1]:""}else b=null,c=a,d="";return{cmd:b,arg1:c,arg2:d}}function e(c,d,e,f,g){switch(null!==c&&a.$emit("addToHistory",g),c){case null:b.sendMessage(f,d);break;case"join":b.joinChannel(d);break;case"part":b.leaveChannel(d||f);break;case"nick":b.changeNickname(d);break;case"users":b.listChannelUsers(d||f);break;case"list":b.listChannels(d);break;case"msg":b.sendPrivateMessage(d,e);break;case"help":b.listCommands();break;case"giphy":b.randomGiphy(f,d.concat(" ",e));break;case"me":b.meAction(f,d.concat(" ",e));break;case"ame":b.ameAction(d.concat(" ",e));break;case"amsg":b.sendMessageAll(d.concat(" ",e));break;case"whois":b.whois(d);break;case"ausers":b.listServerUsers();break;case"uptime":b.getUptime();break;default:a.$emit("unknowCommand",{error:!0,nickname:"",message:"Unknown command, please refer to /help.",timestamp:(new Date).getTime()})}}var f={go:c,parse:d,decide:e};return f}angular.module("my_irc").factory("commandsParserService",a),a.$inject=["$rootScope","commandsService"]}(),function(){"use strict";function a(a,b,c,d){function e(b){return c.joinChannel(b,function(b){return b.error?a.$emit("selfJoinChannelMessage",b):a.$emit("selfJoinChannel",b)})}function f(b){return c.leaveChannel(b,function(b){return b.error?a.$emit("selfLeftChannelMessage",b):a.$emit("selfLeaveChannel",b)})}function g(c){return b.changeNickname(c,function(b){return a.$emit("selfChangeNickname",b)})}function h(b){return c.listChannelUsers(b,function(b){return a.$emit("listChannelUsers",b)})}function i(b){return c.listChannels(b,function(b){return a.$emit("listChannels",b)})}function j(b,c){return d.sendPrivateMessage(b,c,function(b){return a.$emit("selfPrivateMessageSent",b)})}function k(b,c){return d.sendMessage(b,c,function(b){if(b.error)return a.$emit("selfMessageSent",b)})}function l(){return b.listCommands(function(b){return a.$emit("listCommands",b)})}function m(b,c){return d.randomGiphy(b,c,function(b){if(b.error)return a.$emit("giphyError",b)})}function n(b,c){return d.meAction(b,c,function(b){if(b.error)return a.$emit("selfMeAction",b)})}function o(b){return d.ameAction(b,function(b){if(b.error)return a.$emit("selfAmeAction",b)})}function p(b){return d.sendMessageAll(b,function(b){if(b.error)return a.$emit("selfMessageAllSent",b)})}function q(c){return b.whois(c,function(b){return a.$emit("whois",b)})}function r(){return b.listServerUsers(function(b){return a.$emit("listServerUsers",b)})}function s(){return b.getUptime(function(b){return a.$emit("getUptime",b)})}var t={joinChannel:e,leaveChannel:f,changeNickname:g,listChannelUsers:h,listChannels:i,sendPrivateMessage:j,sendMessage:k,listCommands:l,randomGiphy:m,meAction:n,ameAction:o,sendMessageAll:p,whois:q,listServerUsers:r,getUptime:s};return t}angular.module("my_irc").factory("commandsService",a),a.$inject=["$rootScope","indexIrcService","channelsIrcService","messagesIrcService"]}(),function(){"use strict";function a(){function a(a){return a<10&&(a="0"+a),a}function b(a){var b=new Date(a),c=b.getUTCMonth()+1;c=this.leftPadDate(c);var d=b.getUTCDate();d=this.leftPadDate(d);var e=b.getUTCFullYear(),f=b.getUTCHours();f=this.leftPadDate(f);var g=b.getUTCMinutes();g=this.leftPadDate(g);var h=b.getUTCSeconds();return h=this.leftPadDate(h),{year:e,month:c,day:d,hours:f,minutes:g,secondes:h}}function c(a){var b=this.formatDate(a.timestamp),c=this.formatNickname(a.nickname),d=this.formatContent(a.message,a.data),e=a.attachment,f=this.getYoutubeVideoId(d);return{text:b+" "+c+" "+d,nickname:a.nickname,content:d,date:b,attachment:e,videoId:f}}function d(a){var b=this.computeDate(a);return b.hours+":"+b.minutes+":"+b.secondes}function e(a){return a.length>0?"<"+a+">":""}function f(a,b){return a=a.trim(),b&&b.forEach(function(b){a=a+"\n - "+b}),a}function g(a){var b=/(?:youtube\.com\/\S*(?:(?:\/e(?:mbed))?\/|watch\?(?:\S*?&?v\=))|youtu\.be\/)([a-zA-Z0-9_-]{6,11})/,c=a.match(b);return null!==c?c[1]:null}var h={leftPadDate:a,computeDate:b,format:c,formatDate:d,formatNickname:e,formatContent:f,getYoutubeVideoId:g};return h}angular.module("my_irc").factory("formatterService",a)}(),function(){"use strict";function a(a,b){function c(b,c){a.emit("changeNickname",b,c)}function d(b){a.emit("listCommands",b)}function e(b,c){a.emit("whois",b,c)}function f(b){a.emit("listServerUsers",b)}function g(b){a.emit("getUptime",b)}var h={changeNickname:c,listCommands:d,whois:e,listServerUsers:f,getUptime:g};return a.on("hasChangeNickname",function(a){b.$emit("hasChangeNickname",a)}),a.on("handshake",function(a){b.$emit("handshake",a)}),a.on("disconnect",function(){b.$emit("disconnect")}),h}angular.module("my_irc").factory("indexIrcService",a),a.$inject=["socketService","$rootScope"]}(),function(){"use strict";function a(a,b){function c(b,c,d){a.emit("sendPrivateMessage",b,c,d)}function d(b,c,d){a.emit("sendMessage",b,c,d)}function e(b,c,d){a.emit("randomGiphy",b,c,d)}function f(b,c,d){a.emit("meAction",b,c,d)}function g(b,c){a.emit("ameAction",b,c)}function h(b,c){a.emit("sendMessageAll",b,c)}var i={sendPrivateMessage:c,sendMessage:d,randomGiphy:e,meAction:f,ameAction:g,sendMessageAll:h};return a.on("receivePrivateMessage",function(a){b.$emit("receivePrivateMessage",a)}),a.on("receiveMessage",function(a){b.$emit("receiveMessage",a)}),i}angular.module("my_irc").factory("messagesIrcService",a),a.$inject=["socketService","$rootScope"]}(),function(){"use strict";function a(a,b){function c(b,c){var d=this.format(c),e={body:d,autoClose:3e3};a.showNotification(b,e,this.notifHandler)}function d(a,b){}function e(a){var b="";return"SERVER"!==a.nickname&&(b+="<"+a.nickname+"> "),b+=a.content}var f={show:c,notifHandler:d,format:e};return f}angular.module("my_irc").factory("notificationsService",a),a.$inject=["webNotification","$rootScope"]}(),function(){"use strict";function a(a){return a()}angular.module("my_irc").factory("socketService",a),a.$inject=["socketFactory"]}();